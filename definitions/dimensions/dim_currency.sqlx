config {
  type: "table",
  schema: "team_4",
  description: "Currency dimension",
  tags: ["dimension", "phase5"],
  assertions: {
    uniqueKey: ["currency_key"],
    nonNull: ["currency_key", "currency_code"]
  }
}

SELECT
  ROW_NUMBER() OVER (ORDER BY c.CurrencyCode) AS currency_key,
  c.CurrencyCode AS currency_code,
  c.Name AS currency_name,
  CURRENT_TIMESTAMP() AS loaded_at
FROM ${ref('Sales_Currency')} c

