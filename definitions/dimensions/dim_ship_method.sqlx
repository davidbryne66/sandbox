config {
  type: "table",
  schema: "team_4",
  description: "Shipping method dimension",
  tags: ["dimension", "phase3"],
  assertions: {
    uniqueKey: ["ship_method_key"],
    nonNull: ["ship_method_key", "ship_method_name"]
  }
}

SELECT
  sm.ShipMethodID AS ship_method_key,
  sm.ShipMethodID AS ship_method_id,
  sm.Name AS ship_method_name,
  sm.ShipBase AS ship_base_cost,
  sm.ShipRate AS ship_rate,
  CURRENT_TIMESTAMP() AS loaded_at
FROM ${ref('Purchasing_ShipMethod')} sm

